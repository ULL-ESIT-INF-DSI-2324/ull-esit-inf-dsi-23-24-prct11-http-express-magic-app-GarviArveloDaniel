<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>DSI - Group R</title><meta name="description" content="Documentation for DSI - Group R"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">DSI - Group R</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>DSI - Group R</h2></div><div class="tsd-panel tsd-typography"><a id="md:práctica-11---aplicación-express-para-coleccionistas-de-cartas-magic" class="tsd-anchor"></a><h1><a href="#md:práctica-11---aplicación-express-para-coleccionistas-de-cartas-magic">Práctica 11 - Aplicación Express para coleccionistas de cartas Magic</a></h1><p><a href="https://sonarcloud.io/summary/new_code?id=ULL-ESIT-INF-DSI-2324_ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-GarviArveloDaniel"><img src="https://sonarcloud.io/api/project_badges/measure?project=ULL-ESIT-INF-DSI-2324_ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-GarviArveloDaniel&metric=alert_status" alt="Quality Gate Status"></a><a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-GarviArveloDaniel?branch=main"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-GarviArveloDaniel/badge.svg?branch=main" alt="Coverage Status"></a><a href="https://github.com/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-GarviArveloDaniel/actions/workflows/tests.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-GarviArveloDaniel/actions/workflows/tests.yml/badge.svg" alt="Tests"></a></p>
<p><strong>Información de contacto:</strong></p>
<ul>
<li>Daniel Garvi Arvelo<ul>
<li>GitHub: <a href="https://github.com/GarviArveloDaniel">@GarviArveloDaniel</a></li>
<li>Email: <a href="mailto:alu0101501338@ull.edu.es">alu0101501338@ull.edu.es</a></li>
</ul>
</li>
</ul>
<a id="md:🌳-estructura-del-repositorio" class="tsd-anchor"></a><h2><a href="#md:🌳-estructura-del-repositorio">🌳 Estructura del repositorio</a></h2><pre><code class="language-shell"><span class="hl-0">.</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">Collections</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">edegre</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-3">1</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">│</span><span class="hl-1">   </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-3">2</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-2">testUser</span><br/><span class="hl-0">│</span><span class="hl-1">       </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-3">1</span><br/><span class="hl-0">│</span><span class="hl-1">       </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-3">2</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">package.json</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">package-lock.json</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">README.md</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">sonar-project.properties</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">src</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">card_interface.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">card_utilities.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">collection.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-2">server.ts</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">tests</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-2">server.spec.ts</span><br/><span class="hl-0">└──</span><span class="hl-1"> </span><span class="hl-2">tsconfig.json</span><br/><br/><span class="hl-0">5</span><span class="hl-1"> </span><span class="hl-2">directories,</span><span class="hl-1"> </span><span class="hl-3">14</span><span class="hl-1"> </span><span class="hl-2">files</span>
</code><button>Copy</button></pre>
<a id="md:📚introducción" class="tsd-anchor"></a><h2><a href="#md:📚introducción">📚Introducción</a></h2><p>En esta práctica partimos de la práctica 10, y debemos modificarla para implementarla mediante peticiones http.</p>
<a id="md:📋tareas-previas" class="tsd-anchor"></a><h2><a href="#md:📋tareas-previas">📋Tareas Previas</a></h2><p>Al igual que en prácticas anteriores, en primer lugar acepto la tarea de github Classroom para poder acceder al repositorio y realizo la misma configuración que en la práctica anteior.</p>
<a id="md:enunciado" class="tsd-anchor"></a><h2><a href="#md:enunciado">Enunciado</a></h2><p>En esta práctica, tendrá que basarse en las implementaciones de la aplicación para coleccionistas de cartas Magic que ha llevado a cabo en prácticas pasadas, con el objetivo de que la funcionalidad de dicha aplicación se implemente a través de un servidor HTTP escrito con Express. Desde un cliente como, por ejemplo, ThunderClient o Postman, se podrán llevar a cabo peticiones HTTP al servidor. Las peticiones que podrá realizar el cliente al servidor deberán permitir añadir, modificar, eliminar, listar y mostrar cartas de un usuario concreto. El servidor Express deberá almacenar la información de las cartas como ficheros JSON en el sistema de ficheros, siguiendo la misma estructura de directorios utilizada durante prácticas pasadas.</p>
<a id="md:implementación" class="tsd-anchor"></a><h2><a href="#md:implementación">Implementación</a></h2><a id="md:interfaz-cardinterface" class="tsd-anchor"></a><h3><a href="#md:interfaz-cardinterface">Interfaz CardInterface</a></h3><p>Se desarrolla la interfaz <code>CardInterface</code> que lista todos los atributos que debe poseer una carta Magic, además, se crean una serie de enums <code>Color</code>, <code>CardType</code>, <code>Rarity</code> y <code>StrengthResistanceType</code> que limitan las opciones de ciertos atributos.</p>
<pre><code class="language-ts"><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-5">interface</span><span class="hl-1"> </span><span class="hl-6">CardInterface</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">name</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">manaCost</span><span class="hl-1">: </span><span class="hl-6">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">color</span><span class="hl-1">: </span><span class="hl-6">Color</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">rarity</span><span class="hl-1">: </span><span class="hl-6">Rarity</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">rulesText</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">marketValue</span><span class="hl-1">: </span><span class="hl-6">number</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">strengthResitance</span><span class="hl-1">?: </span><span class="hl-6">StrengthResistanceType</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-7">loyalty</span><span class="hl-1">?: </span><span class="hl-6">number</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-5">enum</span><span class="hl-1"> </span><span class="hl-6">Color</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">white</span><span class="hl-1"> = </span><span class="hl-2">&#39;white&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">blue</span><span class="hl-1"> = </span><span class="hl-2">&#39;blue&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">black</span><span class="hl-1"> = </span><span class="hl-2">&#39;black&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">red</span><span class="hl-1"> = </span><span class="hl-2">&#39;red&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">green</span><span class="hl-1"> = </span><span class="hl-2">&#39;green&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">colorless</span><span class="hl-1"> = </span><span class="hl-2">&#39;colorless&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">multi</span><span class="hl-1"> = </span><span class="hl-2">&#39;multi&#39;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-5">enum</span><span class="hl-1"> </span><span class="hl-6">CardType</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">land</span><span class="hl-1"> = </span><span class="hl-2">&#39;land&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">creature</span><span class="hl-1"> = </span><span class="hl-2">&#39;creature&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">enchantment</span><span class="hl-1"> = </span><span class="hl-2">&#39;enchantment&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">conjure</span><span class="hl-1"> = </span><span class="hl-2">&#39;conjure&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">instant</span><span class="hl-1"> = </span><span class="hl-2">&#39;instant&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">artefact</span><span class="hl-1"> = </span><span class="hl-2">&#39;artefact&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">planeswalker</span><span class="hl-1"> = </span><span class="hl-2">&#39;planeswalker&#39;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-5">enum</span><span class="hl-1"> </span><span class="hl-6">Rarity</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-8">common</span><span class="hl-1"> = </span><span class="hl-2">&#39;common&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">uncommon</span><span class="hl-1"> = </span><span class="hl-2">&#39;uncommon&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">rare</span><span class="hl-1"> = </span><span class="hl-2">&#39;rare&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-8">mythic</span><span class="hl-1"> = </span><span class="hl-2">&#39;mythic&#39;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-5">type</span><span class="hl-1"> </span><span class="hl-6">StrengthResistanceType</span><span class="hl-1"> = [</span><span class="hl-6">number</span><span class="hl-1">, </span><span class="hl-6">number</span><span class="hl-1">];</span>
</code><button>Copy</button></pre>
<a id="md:collection" class="tsd-anchor"></a><h3><a href="#md:collection">Collection</a></h3><p>Se desarrolla una clase <code>Collection</code> con único atributo el path al directorio donde se almacenarán las colecciones. La clase presenta además cinco métodos que usan la API asíncrona de Node fs mediante callbacks:</p>
<ul>
<li><code>add y addCard</code>:</li>
</ul>
<pre><code class="language-ts"><span class="hl-1">  </span><span class="hl-7">public</span><span class="hl-1"> </span><span class="hl-0">add</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-7">card</span><span class="hl-1">: </span><span class="hl-7">CardInterface</span><span class="hl-1">, </span><span class="hl-7">callback</span><span class="hl-1">: (</span><span class="hl-7">error</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-5">void</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">mkdir</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, (</span><span class="hl-7">error</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Error creating the directory: </span><span class="hl-5">${</span><span class="hl-7">error</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">          } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">addCard</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">, </span><span class="hl-7">card</span><span class="hl-1">, </span><span class="hl-7">callback</span><span class="hl-1">);</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">      } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-0">addCard</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">, </span><span class="hl-7">card</span><span class="hl-1">, </span><span class="hl-7">callback</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-7">private</span><span class="hl-1"> </span><span class="hl-0">addCard</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-7">card</span><span class="hl-1">: </span><span class="hl-7">CardInterface</span><span class="hl-1">, </span><span class="hl-7">callback</span><span class="hl-1">: (</span><span class="hl-7">error</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-5">void</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">card</span><span class="hl-9">.</span><span class="hl-7">id</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">writeFile</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">card</span><span class="hl-9">.</span><span class="hl-7">id</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-8">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-7">card</span><span class="hl-1">), (</span><span class="hl-7">error</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Error writing the file: </span><span class="hl-5">${</span><span class="hl-7">error</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">          } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-5">undefined</span><span class="hl-1">, </span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">card</span><span class="hl-9">.</span><span class="hl-7">id</span><span class="hl-5">}</span><span class="hl-2"> added to collection`</span><span class="hl-1">);</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">      } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">card</span><span class="hl-9">.</span><span class="hl-7">id</span><span class="hl-5">}</span><span class="hl-2"> already exists in collection`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">)</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">  }</span>
</code><button>Copy</button></pre>
<p>  En primer lugar comprobamos si existe el directorio con el nombre del usuario (es decir, si existe el usuario), en caso de que no, se crea un directorio con el nombre del usuario y se comprueba si la carta ya existe antes de añadirla. Está dividida en dos partes para mayor simplicidad de lectura. Se hace uso de callbacks para retornar errores o información.</p>
<ul>
<li><code>modify</code>:</li>
</ul>
<pre><code class="language-ts"><span class="hl-7">public</span><span class="hl-1"> </span><span class="hl-0">modify</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-7">card</span><span class="hl-1">: </span><span class="hl-7">CardInterface</span><span class="hl-1">, </span><span class="hl-7">callback</span><span class="hl-1">: (</span><span class="hl-7">error</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-5">void</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`User </span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2"> does not exist.`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">card</span><span class="hl-9">.</span><span class="hl-7">id</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">card</span><span class="hl-9">.</span><span class="hl-7">id</span><span class="hl-5">}</span><span class="hl-2"> does not exist in collection`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">        } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">writeFile</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">card</span><span class="hl-9">.</span><span class="hl-7">id</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-8">JSON</span><span class="hl-1">.</span><span class="hl-0">stringify</span><span class="hl-1">(</span><span class="hl-7">card</span><span class="hl-1">), (</span><span class="hl-7">error</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Error writing the file: </span><span class="hl-5">${</span><span class="hl-7">error</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">            } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-5">undefined</span><span class="hl-1">, </span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">card</span><span class="hl-9">.</span><span class="hl-7">id</span><span class="hl-5">}</span><span class="hl-2"> modified`</span><span class="hl-1">);</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  Primero comprobamos si existe el usuario y posteriormente si existe la carta, en caso de que si, se sobreescribe el fichero. Se hace uso de callbacks para retornar errores o información.</p>
<ul>
<li><code>remove</code>:</li>
</ul>
<pre><code class="language-ts"><span class="hl-7">public</span><span class="hl-1"> </span><span class="hl-0">remove</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-7">cardId</span><span class="hl-1">: </span><span class="hl-7">number</span><span class="hl-1">, </span><span class="hl-7">callback</span><span class="hl-1">: (</span><span class="hl-7">error</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-5">void</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`User </span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2"> does not exist.`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2"> does not exist in collection`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">        } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">unlink</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, (</span><span class="hl-7">error</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Error removing the file: </span><span class="hl-5">${</span><span class="hl-7">error</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">            } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-5">undefined</span><span class="hl-1">, </span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2"> removed from collection`</span><span class="hl-1">);</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  De forma similar a la anterior, comprobamos la existencia del usuario y carta, y la eliminamos, usando callbacks para el retorno de errores o información.</p>
<ul>
<li><code>list</code>:</li>
</ul>
<pre><code class="language-ts"><span class="hl-7">public</span><span class="hl-1"> </span><span class="hl-0">list</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-7">callback</span><span class="hl-1">: (</span><span class="hl-7">error</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">[] | </span><span class="hl-6">undefined</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-5">void</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`User </span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2"> does not exist.`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">readdir</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, (</span><span class="hl-7">error</span><span class="hl-1">, </span><span class="hl-7">files</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Error reading the directory: </span><span class="hl-5">${</span><span class="hl-7">error</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">        } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-8">fullContent</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">[] = [];</span><br/><span class="hl-1">          </span><span class="hl-7">files</span><span class="hl-1">.</span><span class="hl-0">forEach</span><span class="hl-1">(</span><span class="hl-7">file</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">readFile</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">file</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, (</span><span class="hl-7">error</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">                </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Error reading the file: </span><span class="hl-5">${</span><span class="hl-7">error</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">              } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-7">fullContent</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">(</span><span class="hl-7">data</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">());</span><br/><span class="hl-1">                </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">fullContent</span><span class="hl-1">.</span><span class="hl-7">length</span><span class="hl-1"> === </span><span class="hl-7">files</span><span class="hl-1">.</span><span class="hl-7">length</span><span class="hl-1">) {</span><br/><span class="hl-1">                  </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-5">undefined</span><span class="hl-1">, </span><span class="hl-7">fullContent</span><span class="hl-1">);</span><br/><span class="hl-1">                }</span><br/><span class="hl-1">              }</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  Realizamos las comprobaciones pertinentes y para listar todas las cartas primero cargamos todas las cartas de un usuario y luego mediante un forEach almacenamos la información de las cartas en un vector, cuando el vector tenga todas las cartas se llama al callback para retornar la información.</p>
<ul>
<li><code>read</code>:</li>
</ul>
<pre><code class="language-ts"><span class="hl-7">public</span><span class="hl-1"> </span><span class="hl-0">read</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-7">cardId</span><span class="hl-1">: </span><span class="hl-7">number</span><span class="hl-1">, </span><span class="hl-7">callback</span><span class="hl-1">: (</span><span class="hl-7">error</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-5">void</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`User </span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2"> does not exist.`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">access</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-7">constants</span><span class="hl-1">.</span><span class="hl-8">F_OK</span><span class="hl-1">, (</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2"> does not exist in collection`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">        } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-7">fs</span><span class="hl-1">.</span><span class="hl-0">readFile</span><span class="hl-1">(</span><span class="hl-5">this</span><span class="hl-1">.</span><span class="hl-7">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-7">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, (</span><span class="hl-7">error</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-2">`Error reading the file: </span><span class="hl-5">${</span><span class="hl-7">error</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-5">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">            } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-0">callback</span><span class="hl-1">(</span><span class="hl-5">undefined</span><span class="hl-1">, </span><span class="hl-7">data</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">());</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  Para leer una carta, realizamos las correspondientes comprobaciones y devolvemos la información.</p>
<p>Podemos comprobar que en cada caso los mensajes por la consola se pasan en color verde, y los de error en color rojo.</p>
<a id="md:server" class="tsd-anchor"></a><h3><a href="#md:server">Server</a></h3><p>En el archivo server.ts se ha desarrollado un servidor http con Express, usando los siguientes verbos:</p>
<ol>
<li><p>GET /cards: Se muestra información especifica de una carta si se proporciona un usuario y un id de la carta. Si no se especifica el id se muestran todas las cartas del usuario.</p>
</li>
<li><p>POST /cards: Se añade una carta a la colección, el usuario se especifica por la query string y la carta en el cuerpo de la petición.</p>
</li>
<li><p>DELETE /cards: Se elimina una carta de la colección, hay que especificar un usuario y un id en la query string.</p>
</li>
<li><p>PATCH /cards: Se modifica una carta existente, hay que proporcionar un usuario y un id a través de la query, y la nueva información de la carta en el cuerpo de la petición.</p>
</li>
</ol>
<pre><code class="language-ts"><span class="hl-7">server</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/cards&#39;</span><span class="hl-1">, (</span><span class="hl-7">req</span><span class="hl-1">, </span><span class="hl-7">res</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (!</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-2">&#39;A user has to be provided.&#39;</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-4">return</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (!</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">id</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">collection</span><span class="hl-1">.</span><span class="hl-0">list</span><span class="hl-1">(</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-6">string</span><span class="hl-1">, (</span><span class="hl-7">error</span><span class="hl-1">, </span><span class="hl-7">result</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">error</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Success&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">result</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">collection</span><span class="hl-1">.</span><span class="hl-0">read</span><span class="hl-1">(</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-6">string</span><span class="hl-1">, </span><span class="hl-0">parseInt</span><span class="hl-1">(</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">id</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-6">string</span><span class="hl-1">), (</span><span class="hl-7">error</span><span class="hl-1">, </span><span class="hl-7">result</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">error</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Success&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">result</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-7">server</span><span class="hl-1">.</span><span class="hl-0">post</span><span class="hl-1">(</span><span class="hl-2">&#39;/cards&#39;</span><span class="hl-1">, (</span><span class="hl-7">req</span><span class="hl-1">, </span><span class="hl-7">res</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (!</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-2">&#39;A user has to be provided.&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">collection</span><span class="hl-1">.</span><span class="hl-0">add</span><span class="hl-1">(</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-6">string</span><span class="hl-1">, </span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">body</span><span class="hl-1">, (</span><span class="hl-7">error</span><span class="hl-1">, </span><span class="hl-7">result</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">error</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Success&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">result</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-7">server</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;/cards&#39;</span><span class="hl-1">, (</span><span class="hl-7">req</span><span class="hl-1">, </span><span class="hl-7">res</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (!</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-2">&#39;A user has to be provided.&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-4">return</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (!</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">id</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-2">&#39;An id has to be provided.&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">collection</span><span class="hl-1">.</span><span class="hl-0">remove</span><span class="hl-1">(</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-6">string</span><span class="hl-1">, </span><span class="hl-0">parseInt</span><span class="hl-1">(</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">id</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-6">string</span><span class="hl-1">), (</span><span class="hl-7">error</span><span class="hl-1">, </span><span class="hl-7">result</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">error</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Success&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">result</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-7">server</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/cards&#39;</span><span class="hl-1">, (</span><span class="hl-7">req</span><span class="hl-1">, </span><span class="hl-7">res</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (!</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-2">&#39;A user has to be provided.&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-4">return</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-4">if</span><span class="hl-1"> (!</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">id</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-2">&#39;An id has to be provided.&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-0">parseInt</span><span class="hl-1">(</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">id</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-6">string</span><span class="hl-1">) !== </span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">body</span><span class="hl-1">.</span><span class="hl-7">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-2">&#39;The id in the body has to be the same as in the query string.&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-4">return</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-7">collection</span><span class="hl-1">.</span><span class="hl-0">modify</span><span class="hl-1">(</span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">query</span><span class="hl-1">.</span><span class="hl-7">user</span><span class="hl-1"> </span><span class="hl-4">as</span><span class="hl-1"> </span><span class="hl-6">string</span><span class="hl-1">, </span><span class="hl-7">req</span><span class="hl-1">.</span><span class="hl-7">body</span><span class="hl-1">, (</span><span class="hl-7">error</span><span class="hl-1">, </span><span class="hl-7">result</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-7">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Error&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">error</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      } </span><span class="hl-4">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">          </span><span class="hl-7">status:</span><span class="hl-1"> </span><span class="hl-2">&#39;Success&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">          </span><span class="hl-7">answer:</span><span class="hl-1"> </span><span class="hl-7">result</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<a id="md:ejercicio-de-pe" class="tsd-anchor"></a><h2><a href="#md:ejercicio-de-pe">Ejercicio de pe</a></h2><a id="md:descripción-del-ejercicio" class="tsd-anchor"></a><h3><a href="#md:descripción-del-ejercicio">Descripción del ejercicio</a></h3><p>Durante prácticas anteriores, debería haber escrito en alguna clase métodos para añadir, modificar, borrar y actualizar la información de una carta de la colección de un usuario:</p>
<ol>
<li>Escoja dos de esos métodos y haga uso de llamadas a los métodos del API asíncrona basada en promesas de Node.js para gestionar el sistema de ficheros.</li>
<li>Haga que sus propios métodos devuelvan promesas.</li>
<li>Modifique el código fuente que invoca a dichos métodos para gestionar las promesas devueltas por los mismos.</li>
</ol>
<a id="md:solución-implementada" class="tsd-anchor"></a><h3><a href="#md:solución-implementada">Solución implementada</a></h3><p>En mi caso, escogí las opciones de remove y read.</p>
<pre><code class="language-ts"><span class="hl-1">  </span><span class="hl-7">public</span><span class="hl-1"> </span><span class="hl-0">removeWithPromises</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-7">cardId</span><span class="hl-1">: </span><span class="hl-7">number</span><span class="hl-1">): </span><span class="hl-6">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">string</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    return new </span><span class="hl-0">Promise</span><span class="hl-1">((</span><span class="hl-7">resolve</span><span class="hl-1">, </span><span class="hl-7">reject</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">fs</span><span class="hl-1">.</span><span class="hl-6">promises</span><span class="hl-1">.</span><span class="hl-6">access</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-6">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-6">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-6">cardId</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-6">fs</span><span class="hl-1">.</span><span class="hl-6">constants</span><span class="hl-1">.</span><span class="hl-6">F_OK</span><span class="hl-1">)</span><br/><span class="hl-1">      .</span><span class="hl-6">then</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">fs</span><span class="hl-1">.</span><span class="hl-6">promises</span><span class="hl-1">.</span><span class="hl-6">unlink</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-6">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-6">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-6">cardId</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      .</span><span class="hl-6">then</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">resolve</span><span class="hl-1">(</span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2"> removed from collection`</span><span class="hl-1">);</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      .</span><span class="hl-6">catch</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">reject</span><span class="hl-1">(</span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2"> or user does not exist.`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-7">public</span><span class="hl-1"> </span><span class="hl-0">readWithPromise</span><span class="hl-1">(</span><span class="hl-7">username</span><span class="hl-1">: </span><span class="hl-7">string</span><span class="hl-1">, </span><span class="hl-7">cardId</span><span class="hl-1">: </span><span class="hl-7">number</span><span class="hl-1">): </span><span class="hl-6">Promise</span><span class="hl-1">&lt;</span><span class="hl-7">string</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    return new </span><span class="hl-0">Promise</span><span class="hl-1">((</span><span class="hl-7">resolve</span><span class="hl-1">, </span><span class="hl-7">reject</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">fs</span><span class="hl-1">.</span><span class="hl-6">promises</span><span class="hl-1">.</span><span class="hl-6">access</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-6">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-6">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-6">cardId</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">, </span><span class="hl-6">fs</span><span class="hl-1">.</span><span class="hl-6">constants</span><span class="hl-1">.</span><span class="hl-6">F_OK</span><span class="hl-1">)</span><br/><span class="hl-1">      .</span><span class="hl-6">then</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-6">fs</span><span class="hl-1">.</span><span class="hl-6">promises</span><span class="hl-1">.</span><span class="hl-6">readFile</span><span class="hl-1">(</span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-6">fullPath</span><span class="hl-1"> + </span><span class="hl-2">`/</span><span class="hl-5">${</span><span class="hl-6">username</span><span class="hl-5">}</span><span class="hl-2">/</span><span class="hl-5">${</span><span class="hl-6">cardId</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">)</span><br/><span class="hl-1">      })</span><br/><span class="hl-1">      .</span><span class="hl-6">then</span><span class="hl-1">((</span><span class="hl-7">data</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">resolve</span><span class="hl-1">(data.toString());</span><br/><span class="hl-1">      }).</span><span class="hl-6">catch</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">reject</span><span class="hl-1">(</span><span class="hl-2">`Card with id </span><span class="hl-5">${</span><span class="hl-7">cardId</span><span class="hl-5">}</span><span class="hl-2"> or user does not exist.`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span>
</code><button>Copy</button></pre>
<a id="md:💭conclusiones" class="tsd-anchor"></a><h2><a href="#md:💭conclusiones">💭Conclusiones</a></h2><p>En esta práctica hemos trabajado la creación de un servidor http con Express, trabajado con verbos http y el patrón callback.</p>
<a id="md:🔗bibliografía" class="tsd-anchor"></a><h2><a href="#md:🔗bibliografía">🔗Bibliografía</a></h2><p><a href="https://ull-esit-inf-dsi-2324.github.io/prct11-http-express-magic-app/">Guión de práctica 11</a></p>
<a id="md:🛠️herramientas" class="tsd-anchor"></a><h2><a href="#md:🛠️herramientas">🛠️Herramientas</a></h2><p>Algunas de las herramientas que se han utilizado en esta práctica son las siguientes:</p>
<p><img src="https://img.shields.io/badge/GitHub-100000?style=for-the-badge&logo=github&logoColor=white" /> <img src="https://img.shields.io/badge/GitHub%20Pages-222222?style=for-the-badge&logo=GitHub%20Pages&logoColor=white"/>  <img src="https://img.shields.io/badge/Github%20Actions-282a2e?style=for-the-badge&logo=githubactions&logoColor=367cfe"/> <img src="https://img.shields.io/badge/eslint-3A33D1?style=for-the-badge&logo=eslint&logoColor=white"/> <img src="https://img.shields.io/badge/prettier-1A2C34?style=for-the-badge&logo=prettier&logoColor=F7BA3E"/> <img src="https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white"/> <img src="https://img.shields.io/badge/npm-CB3837?style=for-the-badge&logo=npm&logoColor=white"/> <img src="https://img.shields.io/badge/Node%20js-339933?style=for-the-badge&logo=nodedotjs&logoColor=white"/> <img src="https://img.shields.io/badge/Mocha-8D6748?style=for-the-badge&logo=Mocha&logoColor=white"/> <img src="https://img.shields.io/badge/chai-A30701?style=for-the-badge&logo=chai&logoColor=white"/></p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:práctica-11---aplicación-express-para-coleccionistas-de-cartas-magic"><span>Práctica 11 -<wbr/> <wbr/>Aplicación <wbr/>Express para coleccionistas de cartas <wbr/>Magic</span></a><ul><li><a href="#md:🌳-estructura-del-repositorio"><span>🌳 <wbr/>Estructura del repositorio</span></a></li><li><a href="#md:📚introducción"><span>📚<wbr/>Introducción</span></a></li><li><a href="#md:📋tareas-previas"><span>📋<wbr/>Tareas <wbr/>Previas</span></a></li><li><a href="#md:enunciado"><span>Enunciado</span></a></li><li><a href="#md:implementación"><span>Implementación</span></a></li><li><ul><li><a href="#md:interfaz-cardinterface"><span>Interfaz <wbr/>Card<wbr/>Interface</span></a></li><li><a href="#md:collection"><span>Collection</span></a></li><li><a href="#md:server"><span>Server</span></a></li></ul></li><li><a href="#md:ejercicio-de-pe"><span>Ejercicio de pe</span></a></li><li><ul><li><a href="#md:descripción-del-ejercicio"><span>Descripción del ejercicio</span></a></li><li><a href="#md:solución-implementada"><span>Solución implementada</span></a></li></ul></li><li><a href="#md:💭conclusiones"><span>💭<wbr/>Conclusiones</span></a></li><li><a href="#md:🔗bibliografía"><span>🔗<wbr/>Bibliografía</span></a></li><li><a href="#md:🛠️herramientas"><span>🛠️<wbr/>Herramientas</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>DSI - Group R</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><div class="tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div></body></html>